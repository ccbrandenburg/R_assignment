---
title: "R Assignment"
output: html_document
---
Questions we might want to answer, just add below:

Is there a relationship between topic and shares?
If so what is the best performing topic?

Weekday vs weekends
-which topics perform best when?

Best performing article?


Loading libraries
```{r library}
library(ggplot2)
library(dplyr)
```

Loading and examining the data
```{r load data and examine}
data=read.csv("OnlineNewsPopularity.csv")
glimpse(data)
dim(data)
tbl_df(data)
```

Reducing Data:
1. __filter__    : To select some rows of the dataset
2. __select__    : To select columns
3. __arrange__   : To sort observations
4. __mutate__    : To modify the structure of the dataset (add variables, etc.)
5. __summarize__ : Together with group_by(), used to reduce variables to values

```{r reduction}
#reducing the dataset to relevent variables
#feel free to add any. I would say we try to have our code mainly refer to the below dataset, fine?
data_s = data %>%
  select(url,
         num_keywords,
         n_tokens_title,
         num_imgs,
         num_videos,
         weekday_is_monday, 
         weekday_is_tuesday, 
         weekday_is_wednesday,
         weekday_is_thursday, 
         weekday_is_friday,
         weekday_is_saturday,
         weekday_is_sunday,
         is_weekend,
         rate_positive_words,
         rate_negative_words,
         title_sentiment_polarity,
         data_channel_is_lifestyle,
         data_channel_is_socmed,
         data_channel_is_tech,
         data_channel_is_world,
         data_channel_is_entertainment,
         data_channel_is_bus,
         title_subjectivity,
         title_sentiment_polarity,
         abs_title_subjectivity,
         abs_title_sentiment_polarity,
         average_token_length,
         shares)
```

First exploration
```{r}
qplot(data=data_s,
      n_tokens_title,
      geom="histogram")

qplot(data=data_s,
      rate_positive_words,
      shares,
      log="xy")

cor(data_s$rate_positive_words, data_s$shares)
  
qplot(data=data_s,
      title_sentiment_polarity,
      geom="histogram")   

qplot(data=data_s,
      title_sentiment_polarity,
      shares)

summary(data_s$shares)

```

Mutating variables
```{r mutate weekday and weekend variables}
library(dplyr)
data_s = data_s %>%
  #create weekday variable 
  mutate(weekday = ifelse(weekday_is_monday==1, 1,
                    ifelse(weekday_is_tuesday==1, 2,
                    ifelse(weekday_is_wednesday==1, 3,
                    ifelse(weekday_is_thursday==1, 4,
                    ifelse(weekday_is_friday==1, 5,
                    ifelse(weekday_is_saturday==1, 6,
                    ifelse(weekday_is_sunday==1, 7,0)))))))) %>%
  mutate(weekday_flag = ifelse(weekday<=5, 1, 0)) %>%
  #create channel variable
  mutate(data_channel = ifelse(data_channel_is_entertainment==1, "Entertainment",
                        ifelse(data_channel_is_bus==1, "Business",
                        ifelse(data_channel_is_socmed==1, "Social Media",
                        ifelse(data_channel_is_tech==1, "Tech",
                        ifelse(data_channel_is_world==1, "World",
                        ifelse(data_channel_is_lifestyle==1, "Lifestyle", "Other")))))))





qplot(data=data_s,
      factor(weekday),
      shares,
      position="jitter")
#number of articles per section
qplot(data=data_s,
      data_channel,
      geom="histogram")

                        
sum(data_s$weekday_flag)              
sum(data_s$weekday)
```

Question: Which article was shared the most?
```{r}
#Article with the highest number of shares
data_s$url[which.max(data_s$shares)]
max(data_s$shares)
```

